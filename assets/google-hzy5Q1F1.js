import{R as y,r as l,a as G}from"./mui-DPYw4arl.js";import{g as Q}from"./react-DoC2WAmd.js";var B,H;function X(){return H||(H=1,B=function t(e,n){if(e===n)return!0;if(e&&n&&typeof e=="object"&&typeof n=="object"){if(e.constructor!==n.constructor)return!1;var o,r,a;if(Array.isArray(e)){if(o=e.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!t(e[r],n[r]))return!1;return!0}if(e.constructor===RegExp)return e.source===n.source&&e.flags===n.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===n.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===n.toString();if(a=Object.keys(e),o=a.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,a[r]))return!1;for(r=o;r--!==0;){var s=a[r];if(!t(e[s],n[s]))return!1}return!0}return e!==e&&n!==n}),B}var ee=X();const te=Q(ee);function M(){return M=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var o in n)({}).hasOwnProperty.call(n,o)&&(t[o]=n[o])}return t},M.apply(null,arguments)}function P(t,e){if(t==null)return{};var n={};for(var o in t)if({}.hasOwnProperty.call(t,o)){if(e.indexOf(o)!==-1)continue;n[o]=t[o]}return n}function ne(t,e){if(typeof t!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var o=n.call(t,e);if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}function oe(t){var e=ne(t,"string");return typeof e=="symbol"?e:e+""}const S={NOT_LOADED:"NOT_LOADED",LOADING:"LOADING",LOADED:"LOADED",FAILED:"FAILED",AUTH_FAILURE:"AUTH_FAILURE"},re="https://maps.googleapis.com/maps/api/js";class D{static async load(e,n){var o;const r=e.libraries?e.libraries.split(","):[],a=this.serializeParams(e);this.listeners.push(n),(o=window.google)!=null&&(o=o.maps)!=null&&o.importLibrary?(this.serializedApiParams||(this.loadingStatus=S.LOADED),this.notifyLoadingStatusListeners()):(this.serializedApiParams=a,this.initImportLibrary(e)),this.serializedApiParams&&this.serializedApiParams!==a&&console.warn("[google-maps-api-loader] The maps API has already been loaded with different parameters and will not be loaded again. Refresh the page for new values to have effect.");const s=["maps",...r];await Promise.all(s.map(i=>google.maps.importLibrary(i)))}static serializeParams(e){return[e.v,e.key,e.language,e.region,e.authReferrerPolicy,e.solutionChannel].join("/")}static initImportLibrary(e){if(window.google||(window.google={}),window.google.maps||(window.google.maps={}),window.google.maps.importLibrary){console.error("[google-maps-api-loader-internal]: initImportLibrary must only be called once");return}let n=null;const o=()=>n||(n=new Promise((r,a)=>{var s;const i=document.createElement("script"),c=new URLSearchParams;for(const[f,d]of Object.entries(e)){const m=f.replace(/[A-Z]/g,h=>"_"+h[0].toLowerCase());c.set(m,String(d))}c.set("loading","async"),c.set("callback","__googleMapsCallback__"),i.async=!0,i.src=re+"?"+c.toString(),i.nonce=((s=document.querySelector("script[nonce]"))==null?void 0:s.nonce)||"",i.onerror=()=>{this.loadingStatus=S.FAILED,this.notifyLoadingStatusListeners(),a(new Error("The Google Maps JavaScript API could not load."))},window.__googleMapsCallback__=()=>{this.loadingStatus=S.LOADED,this.notifyLoadingStatusListeners(),r()},window.gm_authFailure=()=>{this.loadingStatus=S.AUTH_FAILURE,this.notifyLoadingStatusListeners()},this.loadingStatus=S.LOADING,this.notifyLoadingStatusListeners(),document.head.append(i)}),n);google.maps.importLibrary=r=>o().then(()=>google.maps.importLibrary(r))}static notifyLoadingStatusListeners(){for(const e of this.listeners)e(this.loadingStatus)}}D.loadingStatus=S.NOT_LOADED;D.serializedApiParams=void 0;D.listeners=[];const ae=["onLoad","onError","apiKey","version","libraries"],ie=["children"],se="GMP_visgl_rgmlibrary_v1_default",x=y.createContext(null);function le(){const[t,e]=l.useState({});return{mapInstances:t,addMapInstance:(a,s="default")=>{e(i=>M({},i,{[s]:a}))},removeMapInstance:(a="default")=>{e(s=>P(s,[a].map(oe)))},clearMapInstances:()=>{e({})}}}function ue(t){const{onLoad:e,onError:n,apiKey:o,version:r,libraries:a=[]}=t,s=P(t,ae),[i,c]=l.useState(D.loadingStatus),[f,d]=l.useReducer((u,p)=>u[p.name]?u:M({},u,{[p.name]:p.value}),{}),m=l.useMemo(()=>a==null?void 0:a.join(","),[a]),h=l.useMemo(()=>JSON.stringify(M({apiKey:o,version:r},s)),[o,r,s]),g=l.useCallback(async u=>{var p;if(f[u])return f[u];if(!((p=google)!=null&&(p=p.maps)!=null&&p.importLibrary))throw new Error("[api-provider-internal] importLibrary was called before google.maps.importLibrary was defined.");const E=await window.google.maps.importLibrary(u);return d({name:u,value:E}),E},[f]);return l.useEffect(()=>{(async()=>{try{const u=M({key:o},s);r&&(u.v=r),(m==null?void 0:m.length)>0&&(u.libraries=m),(u.channel===void 0||u.channel<0||u.channel>999)&&delete u.channel,u.solutionChannel===void 0?u.solutionChannel=se:u.solutionChannel===""&&delete u.solutionChannel,await D.load(u,p=>c(p));for(const p of["core","maps",...a])await g(p);e&&e()}catch(u){n?n(u):console.error("<ApiProvider> failed to load the Google Maps JavaScript API",u)}})()},[o,m,h]),{status:i,loadedLibraries:f,importLibrary:g}}const Be=t=>{const{children:e}=t,n=P(t,ie),{mapInstances:o,addMapInstance:r,removeMapInstance:a,clearMapInstances:s}=le(),{status:i,loadedLibraries:c,importLibrary:f}=ue(n),d=l.useMemo(()=>({mapInstances:o,addMapInstance:r,removeMapInstance:a,clearMapInstances:s,status:i,loadedLibraries:c,importLibrary:f}),[o,r,a,s,i,c,f]);return y.createElement(x.Provider,{value:d},e)};function ce(t,e){for(const n of me){const o=e[n],r=Z[n];l.useEffect(()=>{if(!t||!o)return;const a=google.maps.event.addListener(t,r,s=>{o(de(r,t,s))});return()=>a.remove()},[t,r,o])}}function de(t,e,n){const o={type:t,map:e,detail:{},stoppable:!1,stop:()=>{}};if(fe.includes(t)){const a=o,s=e.getCenter(),i=e.getZoom(),c=e.getHeading()||0,f=e.getTilt()||0,d=e.getBounds();return(!s||!d||!Number.isFinite(i))&&console.warn("[createEvent] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),a.detail={center:(s==null?void 0:s.toJSON())||{lat:0,lng:0},zoom:i||0,heading:c,tilt:f,bounds:(d==null?void 0:d.toJSON())||{north:90,east:180,south:-90,west:-180}},a}else if(ge.includes(t)){var r;if(!n)throw new Error("[createEvent] mouse events must provide a srcEvent");const a=o;return a.domEvent=n.domEvent,a.stoppable=!0,a.stop=()=>n.stop(),a.detail={latLng:((r=n.latLng)==null?void 0:r.toJSON())||null,placeId:n.placeId},a}return o}const Z={onBoundsChanged:"bounds_changed",onCenterChanged:"center_changed",onClick:"click",onContextmenu:"contextmenu",onDblclick:"dblclick",onDrag:"drag",onDragend:"dragend",onDragstart:"dragstart",onHeadingChanged:"heading_changed",onIdle:"idle",onIsFractionalZoomEnabledChanged:"isfractionalzoomenabled_changed",onMapCapabilitiesChanged:"mapcapabilities_changed",onMapTypeIdChanged:"maptypeid_changed",onMousemove:"mousemove",onMouseout:"mouseout",onMouseover:"mouseover",onProjectionChanged:"projection_changed",onRenderingTypeChanged:"renderingtype_changed",onTilesLoaded:"tilesloaded",onTiltChanged:"tilt_changed",onZoomChanged:"zoom_changed",onCameraChanged:"bounds_changed"},fe=["bounds_changed","center_changed","heading_changed","tilt_changed","zoom_changed"],ge=["click","contextmenu","dblclick","mousemove","mouseout","mouseover"],me=Object.keys(Z);function pe(t,e){const n=l.useRef(void 0);(!n.current||!te(e,n.current))&&(n.current=e),l.useEffect(t,n.current)}const he=new Set(["backgroundColor","clickableIcons","controlSize","disableDefaultUI","disableDoubleClickZoom","draggable","draggableCursor","draggingCursor","fullscreenControl","fullscreenControlOptions","gestureHandling","headingInteractionEnabled","isFractionalZoomEnabled","keyboardShortcuts","mapTypeControl","mapTypeControlOptions","mapTypeId","maxZoom","minZoom","noClear","panControl","panControlOptions","restriction","rotateControl","rotateControlOptions","scaleControl","scaleControlOptions","scrollwheel","streetView","streetViewControl","streetViewControlOptions","styles","tiltInteractionEnabled","zoomControl","zoomControlOptions"]);function ve(t,e){const n={},o=Object.keys(e);for(const r of o)he.has(r)&&(n[r]=e[r]);pe(()=>{t&&t.setOptions(n)},[n])}function q(){var t;return((t=l.useContext(x))==null?void 0:t.status)||S.NOT_LOADED}function ye(t,e){const{viewport:n,viewState:o}=e,r=!!n;return l.useLayoutEffect(()=>{if(!t||!o)return;const{latitude:a,longitude:s,bearing:i,pitch:c,zoom:f}=o;t.moveCamera({center:{lat:a,lng:s},heading:i,tilt:c,zoom:f+1})},[t,o]),r}function Ce(t){return!t||typeof t!="object"||!("lat"in t&&"lng"in t)?!1:Number.isFinite(t.lat)&&Number.isFinite(t.lng)}function J(t){return Ce(t)?t:t.toJSON()}function Ee(t,e,n){const o=n.center?J(n.center):null;let r=null,a=null;o&&Number.isFinite(o.lat)&&Number.isFinite(o.lng)&&(r=o.lat,a=o.lng);const s=Number.isFinite(n.zoom)?n.zoom:null,i=Number.isFinite(n.heading)?n.heading:null,c=Number.isFinite(n.tilt)?n.tilt:null;l.useLayoutEffect(()=>{if(!t)return;const f={};let d=!1;r!==null&&a!==null&&(e.current.center.lat!==r||e.current.center.lng!==a)&&(f.center={lat:r,lng:a},d=!0),s!==null&&e.current.zoom!==s&&(f.zoom=s,d=!0),i!==null&&e.current.heading!==i&&(f.heading=i,d=!0),c!==null&&e.current.tilt!==c&&(f.tilt=c,d=!0),d&&t.moveCamera(f)})}const be=()=>{const t={position:"absolute",top:0,left:0,bottom:0,right:0,zIndex:999,display:"flex",flexFlow:"column nowrap",textAlign:"center",justifyContent:"center",fontSize:".8rem",color:"rgba(0,0,0,0.6)",background:"#dddddd",padding:"1rem 1.5rem"};return y.createElement("div",{style:t},y.createElement("h2",null,"Error: AuthFailure"),y.createElement("p",null,"A problem with your API key prevents the map from rendering correctly. Please make sure the value of the ",y.createElement("code",null,"APIProvider.apiKey")," prop is correct. Check the error-message in the console for further details."))};function Le(){const[t,e]=l.useState(null),n=l.useCallback(o=>e(o),[e]);return[t,n]}function V(){return q()===S.LOADED}function Me(){const[,t]=l.useReducer(e=>e+1,0);return t}function we(t,e){const n=t.getCenter(),o=t.getZoom(),r=t.getHeading()||0,a=t.getTilt()||0,s=t.getBounds();(!n||!s||!Number.isFinite(o))&&console.warn("[useTrackedCameraState] at least one of the values from the map returned undefined. This is not expected to happen. Please report an issue at https://github.com/visgl/react-google-maps/issues/new"),Object.assign(e.current,{center:(n==null?void 0:n.toJSON())||{lat:0,lng:0},zoom:o||0,heading:r,tilt:a})}function Oe(t){const e=Me(),n=l.useRef({center:{lat:0,lng:0},heading:0,tilt:0,zoom:0});return l.useEffect(()=>{if(!t)return;const o=google.maps.event.addListener(t,"bounds_changed",()=>{we(t,n),e()});return()=>o.remove()},[t,e]),n}const Se=["id","defaultBounds","defaultCenter","defaultZoom","defaultHeading","defaultTilt","reuseMaps","renderingType","colorScheme"],Ie=["padding"];class z{static has(e){return this.entries[e]&&this.entries[e].length>0}static pop(e){return this.entries[e]&&this.entries[e].pop()||null}static push(e,n){this.entries[e]||(this.entries[e]=[]),this.entries[e].push(n)}}z.entries={};function ke(t,e){const n=V(),[o,r]=l.useState(null),[a,s]=Le(),i=Oe(o),{id:c,defaultBounds:f,defaultCenter:d,defaultZoom:m,defaultHeading:h,defaultTilt:g,reuseMaps:u,renderingType:p,colorScheme:E}=t,v=P(t,Se),w=t.zoom!==void 0||t.defaultZoom!==void 0,I=t.center!==void 0||t.defaultCenter!==void 0;!f&&(!w||!I)&&console.warn("<Map> component is missing configuration. You have to provide zoom and center (via the `zoom`/`defaultZoom` and `center`/`defaultCenter` props) or specify the region to show using `defaultBounds`. See https://visgl.github.io/react-google-maps/docs/api-reference/components/map#required"),!v.center&&d&&(v.center=d),!v.zoom&&Number.isFinite(m)&&(v.zoom=m),!v.heading&&Number.isFinite(h)&&(v.heading=h),!v.tilt&&Number.isFinite(g)&&(v.tilt=g);for(const b of Object.keys(v))v[b]===void 0&&delete v[b];const k=l.useRef(void 0);return l.useEffect(()=>{if(!a||!n)return;const{addMapInstance:b,removeMapInstance:L}=e,{mapId:O}=t,_=`${O||"default"}:${p||"default"}:${E||"LIGHT"}`;let A,C;if(u&&z.has(_)?(C=z.pop(_),A=C.getDiv(),a.appendChild(A),C.setOptions(v),setTimeout(()=>C.setCenter(C.getCenter()),0)):(A=document.createElement("div"),A.style.height="100%",a.appendChild(A),C=new google.maps.Map(A,M({},v,p?{renderingType:p}:{},E?{colorScheme:E}:{}))),r(C),b(C,c),f){const{padding:F}=f,R=P(f,Ie);C.fitBounds(R,F)}else(!w||!I)&&C.fitBounds({east:180,west:-180,south:-90,north:90});if(k.current){const{mapId:F,cameraState:R}=k.current;F!==O&&C.setOptions(R)}return()=>{k.current={mapId:O,cameraState:i.current},A.remove(),u?z.push(_,C):google.maps.event.clearInstanceListeners(C),r(null),L(c)}},[a,n,c,t.mapId,t.renderingType,t.colorScheme]),[o,s,i]}const K=y.createContext(null),Ae=t=>{const{children:e,id:n,className:o,style:r}=t,a=l.useContext(x),s=q();if(!a)throw new Error("<Map> can only be used inside an <ApiProvider> component.");const[i,c,f]=ke(t,a);Ee(i,f,t),ce(i,t),ve(i,t);const d=ye(i,t),m=!!t.controlled;l.useEffect(()=>{if(i)return d&&i.setOptions({disableDefaultUI:!0}),(d||m)&&i.setOptions({gestureHandling:"none",keyboardShortcuts:!1}),()=>{i.setOptions({gestureHandling:t.gestureHandling,keyboardShortcuts:t.keyboardShortcuts})}},[i,d,m,t.gestureHandling,t.keyboardShortcuts]);const h=t.center?J(t.center):null;let g=null,u=null;h&&Number.isFinite(h.lat)&&Number.isFinite(h.lng)&&(g=h.lat,u=h.lng);const p=l.useMemo(()=>{var w,I,k,b,L;return{center:{lat:(w=g)!=null?w:0,lng:(I=u)!=null?I:0},zoom:(k=t.zoom)!=null?k:0,heading:(b=t.heading)!=null?b:0,tilt:(L=t.tilt)!=null?L:0}},[g,u,t.zoom,t.heading,t.tilt]);l.useLayoutEffect(()=>{if(!i||!m)return;i.moveCamera(p);const w=i.addListener("bounds_changed",()=>{i.moveCamera(p)});return()=>w.remove()},[i,m,p]);const E=l.useMemo(()=>M({width:"100%",height:"100%",position:"relative",zIndex:d?-1:0},r),[r,d]),v=l.useMemo(()=>({map:i}),[i]);return s===S.AUTH_FAILURE?y.createElement("div",{style:M({position:"relative"},o?{}:E),className:o},y.createElement(be,null)):y.createElement("div",M({ref:c,"data-testid":"map",style:o?void 0:E,className:o},n?{id:n}:{}),i?y.createElement(K.Provider,{value:v},e):null)};Ae.deckGLViewProps=!0;const j=new Set;function U(...t){const e=JSON.stringify(t);j.has(e)||(j.add(e),console.error(...t))}const W=(t=null)=>{const e=l.useContext(x),{map:n}=l.useContext(K)||{};if(e===null)return U("useMap(): failed to retrieve APIProviderContext. Make sure that the <APIProvider> component exists and that the component you are calling `useMap()` from is a sibling of the <APIProvider>."),null;const{mapInstances:o}=e;return t!==null?o[t]||null:n||o.default||null};function _e(t){const e=V(),n=l.useContext(x);return l.useEffect(()=>{!e||!n||n.importLibrary(t)},[e,n,t]),(n==null?void 0:n.loadedLibraries[t])||null}function T(t,e,n){l.useEffect(()=>{if(!t||!e||!n)return;const o=google.maps.event.addListener(t,e,n);return()=>o.remove()},[t,e,n])}function N(t,e,n){l.useEffect(()=>{t&&(t[e]=n)},[t,e,n])}function $(t,e,n){l.useEffect(()=>{if(!(!t||!e||!n))return t.addEventListener(e,n),()=>t.removeEventListener(e,n)},[t,e,n])}function Pe(t){return t.nodeType===Node.ELEMENT_NODE}const Y=y.createContext(null),De={BOTTOM:["50%","100%"]},xe=({children:t,styles:e,className:n,anchorPoint:o})=>{const[r,a]=o??De.BOTTOM;let s=`-${r}`,i=`-${a}`;r.trimStart().startsWith("-")&&(s=r.substring(1)),a.trimStart().startsWith("-")&&(i=a.substring(1));const c=`translate(50%, 100%) translate(${s}, ${i})`;return y.createElement("div",{style:{transform:c}},y.createElement("div",{className:n,style:e},t))};function Te(t){const[e,n]=l.useState(null),[o,r]=l.useState(null),a=W(),s=_e("marker"),{children:i,onClick:c,className:f,onMouseEnter:d,onMouseLeave:m,onDrag:h,onDragStart:g,onDragEnd:u,collisionBehavior:p,clickable:E,draggable:v,position:w,title:I,zIndex:k}=t,b=l.Children.count(i);return l.useEffect(()=>{if(!a||!s)return;const L=new s.AdvancedMarkerElement;L.map=a,n(L);let O=null;return b>0&&(O=document.createElement("div"),O.isCustomMarker=!0,L.content=O,r(O)),()=>{var _;L.map=null,(_=O)==null||_.remove(),n(null),r(null)}},[a,s,b]),l.useEffect(()=>{!e||!e.content||b>0||(e.content.className=f||"")},[e,f,b]),N(e,"position",w),N(e,"title",I??""),N(e,"zIndex",k),N(e,"collisionBehavior",p),l.useEffect(()=>{e&&(v!==void 0?e.gmpDraggable=v:h||g||u?e.gmpDraggable=!0:e.gmpDraggable=!1)},[e,v,h,u,g]),l.useEffect(()=>{if(!e)return;const L=E!==void 0||!!c||!!d||!!m;e.gmpClickable=L,L&&e!=null&&e.content&&Pe(e.content)&&(e.content.style.pointerEvents="none",e.content.firstElementChild&&(e.content.firstElementChild.style.pointerEvents="all"))},[e,E,c,d,m]),T(e,"click",c),T(e,"drag",h),T(e,"dragstart",g),T(e,"dragend",u),$(e==null?void 0:e.element,"mouseenter",d),$(e==null?void 0:e.element,"mouseleave",m),[e,o]}const Ue=l.forwardRef((t,e)=>{const{children:n,style:o,className:r,anchorPoint:a}=t,[s,i]=Te(t),c=l.useMemo(()=>s?{marker:s}:null,[s]);return l.useImperativeHandle(e,()=>s,[s]),i?y.createElement(Y.Provider,{value:c},G.createPortal(y.createElement(xe,{anchorPoint:a,styles:o,className:r},n),i)):null}),Ne=["onClick","onDrag","onDragStart","onDragEnd","onMouseOver","onMouseOut"];function ze(t){const[e,n]=l.useState(null),o=W(),{onClick:r,onDrag:a,onDragStart:s,onDragEnd:i,onMouseOver:c,onMouseOut:f}=t,d=P(t,Ne),{position:m,draggable:h}=d;return l.useEffect(()=>{if(!o){o===void 0&&console.error("<Marker> has to be inside a Map component.");return}const g=new google.maps.Marker(d);return g.setMap(o),n(g),()=>{g.setMap(null),n(null)}},[o]),l.useEffect(()=>{if(!e)return;const g=e,u=google.maps.event;return r&&u.addListener(g,"click",r),a&&u.addListener(g,"drag",a),s&&u.addListener(g,"dragstart",s),i&&u.addListener(g,"dragend",i),c&&u.addListener(g,"mouseover",c),f&&u.addListener(g,"mouseout",f),e.setDraggable(!!h),()=>{u.clearInstanceListeners(g)}},[e,h,r,a,s,i,c,f]),l.useEffect(()=>{e&&d&&e.setOptions(d)},[e,d]),l.useEffect(()=>{h||!m||!e||e.setPosition(m)},[h,m,e]),e}l.forwardRef((t,e)=>{const n=ze(t);return l.useImperativeHandle(e,()=>n,[n]),y.createElement(y.Fragment,null)});const He=t=>{var e;const n=(e=l.useContext(Y))==null?void 0:e.marker,o=l.useMemo(()=>document.createElement("div"),[]);return l.useEffect(()=>{var r;if(!n){n===void 0&&console.error("The <Pin> component can only be used inside <AdvancedMarker>.");return}t.glyph&&t.children&&U("The <Pin> component only uses children to render the glyph if both the glyph property and children are present."),l.Children.count(t.children)>1&&U("Passing multiple children to the <Pin> component might lead to unexpected results.");const a=M({},t),s=new google.maps.marker.PinElement(a);t.children&&(s.glyph=o);const i=(r=n.content)==null||(r=r.firstChild)==null?void 0:r.firstChild;for(;i!=null&&i.firstChild;)i.removeChild(i.firstChild);i&&i.appendChild(s.element)},[n,o,t]),G.createPortal(t.children,o)};export{Be as A,Ae as M,He as P,Ue as a};
